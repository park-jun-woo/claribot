# 개발 실행: TASK-DEV-036 ~ TASK-DEV-043

**일시**: 2026-02-03
**작업**: Claritask.md 스펙 대비 누락 기능 구현

## 배경

이전 세션에서 코드베이스와 Claritask.md 스펙을 비교 분석하여 8개의 누락/불일치 항목을 식별하고 TASK-DEV-036 ~ TASK-DEV-043을 생성했음. 이번 세션에서 해당 Task들을 순차 실행 완료.

## 완료된 Task 목록

### TASK-DEV-036: FDL Verify 명령어
- `internal/service/fdl_service.go`에 `VerifyResult`, `SignatureDiff` 구조체 추가
- `VerifyFDLImplementation` 함수 구현 (FDL과 실제 코드 일치 검증)
- `internal/cmd/fdl.go`에 `fdlVerifyCmd` 추가

### TASK-DEV-037: FDL Diff 명령어
- `DiffResult`, `FileDiff`, `Change` 구조체 추가
- `DiffFDLImplementation` 함수 구현 (FDL-코드 차이점 분석)
- `fdlDiffCmd` 명령어 추가

### TASK-DEV-038: Edge Infer 명령어
- `InferredEdge`, `InferenceContext`, `InferenceItem` 구조체 추가
- `PrepareTaskEdgeInference`, `PrepareFeatureEdgeInference` 함수 구현
- LLM 프롬프트 생성 함수 (`buildTaskInferencePrompt`, `buildFeatureInferencePrompt`)
- `edgeInferCmd` 명령어 추가 (`--feature`, `--project`, `--min-confidence` 플래그)

### TASK-DEV-039: Plan Features 명령어
- `internal/service/plan_service.go` 신규 생성
- `PlannedFeature`, `FeaturePlan`, `FeaturePlanContext` 구조체
- `PreparePlanFeatures` 함수 및 LLM 프롬프트 생성
- `internal/cmd/plan.go` 신규 생성
- `planFeaturesCmd` 명령어 (`--auto-create` 플래그)

### TASK-DEV-040: Skeleton Generator 연동
- `internal/service/skeleton_service.go` 수정
- `RunSkeletonGenerator` 함수 시그니처 변경 (backend, frontend 파라미터 추가)
- `RunSkeletonGeneratorForFeature` 함수 추가 (DB에서 Feature 조회 후 생성)
- `scripts/skeleton_generator.py`는 이미 구현되어 있었음

### TASK-DEV-041: Commands.md 문서 업데이트
- 명령어 구조에 feature, edge, fdl, plan 추가
- 구현 상태 테이블 업데이트 (28개 → 48개 명령어)
- 미구현 섹션을 실제 구현된 명령어 문서로 교체
- 버전 v2.1 → v3.0

### TASK-DEV-042: Feature Tasks 명령어
- `internal/cmd/feature.go`에 `featureTasksCmd` 추가
- `--generate` 플래그 (FDL 없이 LLM으로 Task 생성)
- `internal/service/task_service.go`에 `ListTasksByFeature` 함수 추가

### TASK-DEV-043: Task Pop Manifest 완성
- `internal/model/models.go`의 `Manifest` 구조체에 `Feature` 필드 추가
- `PopTaskFull` 함수에서 Feature 정보를 Manifest에 포함하도록 수정

## 주요 코드 변경

### 신규 파일
```
internal/service/plan_service.go
internal/cmd/plan.go
```

### 수정 파일
```
internal/service/fdl_service.go      # verify, diff 함수
internal/service/edge_service.go     # inference 함수
internal/service/skeleton_service.go # Feature 연동
internal/service/task_service.go     # ListTasksByFeature
internal/cmd/fdl.go                  # verify, diff 명령어
internal/cmd/edge.go                 # infer 명령어
internal/cmd/feature.go              # tasks 명령어
internal/cmd/root.go                 # planCmd 등록
internal/model/models.go             # Manifest.Feature 필드
specs/Commands.md                    # 문서 현행화
Makefile                             # 전역 설치 지원
```

## Makefile 변경

GOBIN 설치 제거, `/usr/local/bin` 전역 설치로 단순화:

```makefile
BINARY_NAME := clari
INSTALL_PATH := /usr/local/bin

install: build
	@sudo mv $(BINARY_NAME) $(INSTALL_PATH)/$(BINARY_NAME)
```

## 설치 확인

```bash
$ which clari
/usr/local/bin/clari

$ clari --help
Available Commands:
  edge, fdl, feature, plan  # 신규 추가된 명령어 확인
```

## 빌드/테스트

모든 변경 후 `go build ./...` 및 `go test ./test/...` 통과 확인.
